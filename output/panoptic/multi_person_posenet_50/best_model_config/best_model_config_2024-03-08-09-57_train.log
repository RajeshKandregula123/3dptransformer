2024-03-08 09:57:44,910 Namespace(cfg='configs/panoptic/best_model_config.yaml', device='cuda', seed=42, world_size=1, dist_url='env://', weight_decay=0.0001, distributed=False)
2024-03-08 09:57:44,916 {'BACKBONE_MODEL': 'pose_resnet',
 'CUDNN': {'BENCHMARK': True, 'DETERMINISTIC': False, 'ENABLED': True},
 'DATASET': {'BBOX': 2000,
             'CAMERA_NUM': 5,
             'COLOR_RGB': True,
             'CROP': True,
             'DATA_AUGMENTATION': False,
             'DATA_FORMAT': 'jpg',
             'DATA_ROOT': None,
             'FLIP': False,
             'PESUDO_GT': None,
             'ROOT': 'data/panoptic-toolbox/data',
             'ROOTIDX': 2,
             'ROT_FACTOR': 45,
             'SCALE_FACTOR': 0.35,
             'TEST_DATASET': 'panoptic',
             'TEST_SUBSET': 'validation',
             'TRAIN_DATASET': 'panoptic',
             'TRAIN_SUBSET': 'train'},
 'DATA_DIR': '',
 'DEBUG': {'DEBUG': True,
           'SAVE_BATCH_IMAGES_GT': True,
           'SAVE_BATCH_IMAGES_PRED': True,
           'SAVE_HEATMAPS_GT': True,
           'SAVE_HEATMAPS_PRED': True},
 'DECODER': {'REGRESS_CUBE_SIZE': [20, 20, 20],
             'REGRESS_GRID_SIZE': [200.0, 200.0, 200.0],
             'activation': 'relu',
             'agnostic_v2vnet': False,
             'aux_loss': True,
             'convert_joint_format_indices': None,
             'd_model': 256,
             'dec_n_points': 4,
             'detach_refpoints_cameraprj_firstlayer': True,
             'dim_feedforward': 1024,
             'dropout': 0.1,
             'epipolar_encoder': False,
             'fuse_view_feats': 'cat_proj',
             'inference_conf_thr': [0.1],
             'loss_heatmap2d': 2.0,
             'loss_joint_type': 'l1',
             'loss_pose_normalize': False,
             'loss_pose_perbone': 5.0,
             'loss_pose_perjoint': 5.0,
             'loss_pose_perjoint_aligned': 5.0,
             'loss_weight_loss_ce': 2.0,
             'lr_decay_epoch': [40],
             'lr_linear_proj_mult': 0.1,
             'match_coord': 'norm',
             'nhead': 8,
             'num_decoder_layers': 6,
             'num_feature_levels': 1,
             'num_instance': 10,
             'num_keypoints': 15,
             'num_views': 5,
             'optimizer': 'adam',
             'pose_embed_layer': 3,
             'pred_class_fuse': 'mean',
             'pred_conf_threshold': 0.5,
             'projattn_posembed_mode': 'use_rayconv',
             'query_adaptation': True,
             'query_embed_type': 'person_joint',
             'return_intermediate_dec': True,
             'use_feat_level': [0, 1, 2],
             'use_loss_pose_perbone': False,
             'use_loss_pose_perjoint_aligned': False,
             'use_loss_pose_perprojection': True,
             'use_quality_focal_loss': False,
             'voxel_regression_type': 'perjoint',
             'with_pose_refine': True},
 'GPUS': '1',
 'LOG_DIR': 'log',
 'LOSS': {'USE_DIFFERENT_JOINTS_WEIGHT': False, 'USE_TARGET_WEIGHT': True},
 'MODEL': 'multi_person_posenet',
 'MODEL_EXTRA': {'DECONV': {'CAT_OUTPUT': True,
                            'KERNEL_SIZE': 4,
                            'NUM_BASIC_BLOCKS': 4,
                            'NUM_CHANNELS': 32,
                            'NUM_DECONVS': 1},
                 'FINAL_CONV_KERNEL': 1,
                 'PRETRAINED_LAYERS': ['*'],
                 'STAGE2': {'BLOCK': 'BASIC',
                            'FUSE_METHOD': 'SUM',
                            'NUM_BLOCKS': [4, 4],
                            'NUM_BRANCHES': 2,
                            'NUM_CHANNELS': [48, 96],
                            'NUM_MODULES': 1},
                 'STAGE3': {'BLOCK': 'BASIC',
                            'FUSE_METHOD': 'SUM',
                            'NUM_BLOCKS': [4, 4, 4],
                            'NUM_BRANCHES': 3,
                            'NUM_CHANNELS': [48, 96, 192],
                            'NUM_MODULES': 4},
                 'STAGE4': {'BLOCK': 'BASIC',
                            'FUSE_METHOD': 'SUM',
                            'NUM_BLOCKS': [4, 4, 4, 4],
                            'NUM_BRANCHES': 4,
                            'NUM_CHANNELS': [48, 96, 192, 384],
                            'NUM_MODULES': 3},
                 'STEM_INPLANES': 64},
 'MULTI_PERSON': {'INITIAL_CUBE_SIZE': [80, 80, 20],
                  'MAX_PEOPLE_NUM': 10,
                  'SPACE_CENTER': [0.0, -500.0, 800.0],
                  'SPACE_SIZE': [8000.0, 8000.0, 2000.0],
                  'THRESHOLD': 0.3},
 'NETWORK': {'AGGRE': True,
             'BETA': 100.0,
             'HEATMAP_SIZE': array([240, 128]),
             'IMAGE_SIZE': array([960, 512]),
             'INPUT_SIZE': 512,
             'NUM_JOINTS': 15,
             'PRETRAINED': '',
             'PRETRAINED_BACKBONE': 'models/pose_resnet50_panoptic.pth.tar',
             'SIGMA': 3,
             'TARGET_TYPE': 'gaussian',
             'USE_GT': False},
 'OUTPUT_DIR': 'output',
 'PICT_STRUCT': {'CUBE_SIZE': [64, 64, 64],
                 'DEBUG': False,
                 'FIRST_NBINS': 16,
                 'GRID_SIZE': [2000.0, 2000.0, 2000.0],
                 'LIMB_LENGTH_TOLERANCE': 150,
                 'PAIRWISE_FILE': '',
                 'RECUR_DEPTH': 10,
                 'RECUR_NBINS': 2,
                 'SHOW_CROPIMG': False,
                 'SHOW_HEATIMG': False,
                 'SHOW_ORIIMG': False,
                 'TEST_PAIRWISE': False},
 'POSE_RESNET': {'DECONV_WITH_BIAS': False,
                 'FINAL_CONV_KERNEL': 1,
                 'NUM_DECONV_FILTERS': [256, 256, 256],
                 'NUM_DECONV_KERNELS': [4, 4, 4],
                 'NUM_DECONV_LAYERS': 3,
                 'NUM_LAYERS': 50},
 'PRINT_FREQ': 100,
 'SMPL': {'concat_smpl': True,
          'init_param_file': 'data/neutral_smpl_mean_params.h5',
          'loss_smpl_2d': 1.0,
          'loss_smpl_3d': 1.0,
          'loss_smpl_adv': 1.0,
          'pred_smpl': False,
          'pred_smpl_fuse': 'mean_before_pred',
          'smpl_embed_layer': 3,
          'smpl_file': 'data/smpl'},
 'TEST': {'BATCH_SIZE': 1,
          'BBOX_FILE': '',
          'BBOX_THRE': 1.0,
          'DETECTOR': 'fpn_dcn',
          'DETECTOR_DIR': '',
          'FLIP_TEST': False,
          'HEATMAP_LOCATION_FILE': 'predicted_heatmaps.h5',
          'IMAGE_THRE': 0.1,
          'IN_VIS_THRE': 0.0,
          'MATCH_IOU_THRE': 0.3,
          'MODEL_FILE': 'model_best.pth.tar',
          'NMS_THRE': 0.6,
          'OKS_THRE': 0.5,
          'POST_PROCESS': False,
          'SHIFT_HEATMAP': False,
          'STATE': 'best',
          'USE_GT_BBOX': False},
 'TRAIN': {'BATCH_SIZE': 1,
           'BEGIN_EPOCH': 0,
           'END_EPOCH': 10,
           'FINETUNE_MODEL': None,
           'GAMMA1': 0.99,
           'GAMMA2': 0.0,
           'LR': 0.0001,
           'LR_FACTOR': 0.1,
           'LR_STEP': [20],
           'MOMENTUM': 0.9,
           'NESTEROV': False,
           'OPTIMIZER': 'adam',
           'RESUME': False,
           'SHUFFLE': True,
           'WD': 0.0001,
           'clip_max_norm': 0.1},
 'WORKERS': 4}
